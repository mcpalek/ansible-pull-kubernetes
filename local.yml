

---
 - hosts: localhost
   connection: local
   become: true
   

   tasks:
   - name: install helm if it does not exist
     unarchive:
        src: https://get.helm.sh/{{ helm_version }}
        dest: /usr/local/bin
        extra_opts: "--strip-components=1"
        owner: root
        group: root
        mode: 0755
        remote_src: true
     args:
      creates: /usr/local/bin/helm

   - name: Update apt repositories and cache on server
     package:
     update_cache: yes
     force_apt_get: yes
     cache_valid_time: 3600

   - name: Upgrade all packages on server
     package:
     upgrade: dist
     force_apt_get: yes